!function(t){var e={};function o(s){if(e[s])return e[s].exports;var i=e[s]={i:s,l:!1,exports:{}};return t[s].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=e,o.d=function(t,e,s){o.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:s})},o.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=0)}([function(t,e,o){"use strict";function s(t,e){return(e||document).querySelector(t)}function i(t,e,o){t.addEventListener(e,o)}function l(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}o.r(e);const n=new class{constructor(t,e){this.model=t,this.view=e,this.view.listenToggleAll(this.toggleAll.bind(this)),this.view.listenNewToDo(this.newToDo.bind(this)),this.view.listenToItemChange(this.endEditItem.bind(this)),this.view.listenToItemRemove(this.removeItem.bind(this)),this.view.listenToItemToggle(this.toggleItem.bind(this)),this.view.listenToRemoveCompleted(this.removeCompleted.bind(this))}setView(t=document.location.hash){const e=t.replace(/^#\//,"");let o;switch(e){case"active":o=this.model.getIncompleted();break;case"completed":o=this.model.getCompleted();break;default:o=this.model.todos}this.view.setToggleAllState(this.model.allComplete()),this.view.setChosenFilter(e),this.view.setMainVisibility(this.model.todos.length),this.view.setFooterVisibility(this.model.todos.length),this.view.setClearButtVisibility(this.model.getCompleted().length),this.view.renderList(o),this.view.updateActiveItemsField(this.model.getIncompleted().length)}newToDo(t){this.model.addItem(t),this.setView()}endEditItem(t,e){this.model.setItemTitle(t,e),this.setView()}toggleAll(t){this.model.setAllCompletion(t),this.setView()}toggleItem(t){this.model.toggleItem(t),this.setView()}removeItem(t){this.model.removeItem(t),this.setView()}removeCompleted(){this.model.removeCompleted(),this.setView()}}(new class{constructor(t){this.todos=[],this.pushToStorage=(()=>{localStorage.setItem(t,JSON.stringify(this.todos))}),this.pullFromStorage=(()=>{this.todos=JSON.parse(localStorage.getItem(t)||"[]")}),this.pullFromStorage()}getCompleted(){return this.todos.filter(t=>t.completed)}getIncompleted(){return this.todos.filter(t=>!t.completed)}setAllCompletion(t){this.todos.forEach(e=>{e.completed=!!t}),this.pushToStorage()}allComplete(){return this.getCompleted().length===this.todos.length}removeCompleted(){this.todos=this.getIncompleted(),this.pushToStorage()}addItem(t){if(t=t.trim()){const e={title:t,id:`${l()+l()}-${l()}-${l()}-${l()}-${l()}${l()}${l()}`,completed:!1};this.todos.push(e),this.pushToStorage()}}setItemTitle(t,e){t=t.trim();const o=this.todos.find(t=>Object.is(t.id,e));t?(o.title=t,this.pushToStorage()):this.removeItem(e)}removeItem(t){this.todos.forEach((e,o)=>{Object.is(e.id,t)&&this.todos.splice(o,1)}),this.pushToStorage()}toggleItem(t){this.todos.forEach(e=>{Object.is(e.id,t)&&(e.completed=!e.completed,this.pushToStorage())})}}("todo-astrielov"),new class{constructor(t){this.templates=t,this.sectionTodoapp=s(".todoapp"),this.sectionMain=s(".main",this.sectionTodoapp),this.inputNewTodo=s(".new-todo",this.sectionTodoapp),this.buttonToggleAll=s(".toggle-all",this.sectionTodoapp),this.buttonClearCompleted=s(".clear-completed",this.sectionTodoapp),this.ulTodoList=s(".todo-list",this.sectionTodoapp),this.counter=s(".todo-count",this.sectionTodoapp),this.footer=s(".footer",this.sectionTodoapp),this.filters=s(".filters",this.sectionTodoapp)}setMainVisibility(t){this.sectionMain.style.display=t?"block":"none"}setFooterVisibility(t){this.footer.style.display=t?"block":"none"}setClearButtVisibility(t){this.buttonClearCompleted.style.display=t?"block":"none"}setToggleAllState(t){this.buttonToggleAll.checked=t}setChosenFilter(t){let e;switch(this.filters.querySelectorAll("a").forEach(t=>t.classList.remove("selected")),t){case"active":e=s("#showActive",this.filters);break;case"completed":e=s("#showCompleted",this.filters);break;default:e=s("#showAll",this.filters)}e.classList.add("selected")}setListContent(t){let e=this.ulTodoList.firstChild;for(;e;)this.ulTodoList.removeChild(e),e=this.ulTodoList.firstChild;this.ulTodoList.appendChild(t)}listenToggleAll(t){i(this.buttonToggleAll,"click",()=>{const e=this.buttonToggleAll.checked;t(e)})}listenNewToDo(t){i(this.inputNewTodo,"change",()=>{t(this.inputNewTodo.value),this.inputNewTodo.value=""})}listenToItemChange(t){i(this.ulTodoList,"dblclick",({target:e})=>{if(!Object.is(e.tagName,"LABEL"))return;const o=e.parentElement.parentElement,s=document.createElement("input");s.classList.add("edit"),s.value=e.innerText,o.appendChild(s),o.classList.add("editing"),s.focus(),i(s,"blur",()=>{s.dataset.cancelled||t(s.value,o.dataset.id),o.classList.remove("editing"),o.removeChild(s)}),i(s,"keydown",t=>{"Escape"===t.key&&(s.dataset.cancelled="true",s.blur()),"Enter"===t.key&&s.blur()})})}listenToItemRemove(t){i(this.ulTodoList,"click",({target:e})=>{if(!e.classList.contains("destroy"))return;const o=e.parentElement.parentElement;t(o.dataset.id)})}listenToRemoveCompleted(t){i(this.buttonClearCompleted,"click",()=>{t()})}listenToItemToggle(t){i(this.ulTodoList,"click",({target:e})=>{if(!e.classList.contains("toggle"))return;const o=e.parentElement.parentElement;o.classList.contains("completed")?o.classList.remove("completed"):o.classList.add("completed"),t(o.dataset.id)})}renderList(t){const e=document.createDocumentFragment();t.forEach(t=>{const o=this.templates.constructor.newItemLi(t);e.appendChild(o)}),this.setListContent(e)}updateActiveItemsField(t){const e=this.templates.constructor.newTodoCountSpan(t);this.counter.parentElement.replaceChild(e,this.counter),this.counter=e}}(new class{static newItemLi(t){const e=document.createElement("li");return e.dataset.id=t.id,e.innerHTML=`<div class="view">\n                      <input class="toggle" type="checkbox">\n                      <label>${t.title}</label>\n                      <button class="destroy"></button>\n                    </div>`,t.completed&&(e.classList.add("completed"),s(".toggle",e).checked=!0),e}static newTodoCountSpan(t){const e=document.createElement("span"),o=t%10==1?"":"s";return e.classList.add("todo-count"),e.innerHTML=`<strong>${t}</strong> item${o} left`,e}}));i(window,"load",()=>n.setView()),i(window,"hashchange",()=>n.setView())}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vanMvaGVscGVycy9oZWxwZXJzLmpzIiwid2VicGFjazovLy8uL2pzL2hlbHBlcnMvaWRfZ2VuZXJhdG9yLmpzIiwid2VicGFjazovLy8uL2pzL2FwcC5qcyIsIndlYnBhY2s6Ly8vLi9qcy9jb250cm9sbGVyL2NvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vLy4vanMvbW9kZWwvc3RvcmVfbW9kZWwuanMiLCJ3ZWJwYWNrOi8vLy4vanMvdmlldy92aWV3LmpzIiwid2VicGFjazovLy8uL2pzL3ZpZXcvdGVtcGxhdGVzLmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJjb25maWd1cmFibGUiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsInZhbHVlIiwibiIsIl9fZXNNb2R1bGUiLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJxcyIsInNlbGVjdG9yIiwic2NvcGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJzZXRMaXN0ZW5lciIsInRhcmdldCIsImV2ZW50VHlwZSIsImNhbGxiYWNrIiwiYWRkRXZlbnRMaXN0ZW5lciIsInM0IiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwidG9TdHJpbmciLCJzdWJzdHJpbmciLCJjb250cm9sbGVyIiwiW29iamVjdCBPYmplY3RdIiwibW9kZWwiLCJ2aWV3IiwidGhpcyIsImxpc3RlblRvZ2dsZUFsbCIsInRvZ2dsZUFsbCIsImJpbmQiLCJsaXN0ZW5OZXdUb0RvIiwibmV3VG9EbyIsImxpc3RlblRvSXRlbUNoYW5nZSIsImVuZEVkaXRJdGVtIiwibGlzdGVuVG9JdGVtUmVtb3ZlIiwicmVtb3ZlSXRlbSIsImxpc3RlblRvSXRlbVRvZ2dsZSIsInRvZ2dsZUl0ZW0iLCJsaXN0ZW5Ub1JlbW92ZUNvbXBsZXRlZCIsInJlbW92ZUNvbXBsZXRlZCIsInJhdyIsImxvY2F0aW9uIiwiaGFzaCIsInJvdXRlIiwicmVwbGFjZSIsImN1cnJlbnRUb2RvcyIsImdldEluY29tcGxldGVkIiwiZ2V0Q29tcGxldGVkIiwidG9kb3MiLCJzZXRUb2dnbGVBbGxTdGF0ZSIsImFsbENvbXBsZXRlIiwic2V0Q2hvc2VuRmlsdGVyIiwic2V0TWFpblZpc2liaWxpdHkiLCJsZW5ndGgiLCJzZXRGb290ZXJWaXNpYmlsaXR5Iiwic2V0Q2xlYXJCdXR0VmlzaWJpbGl0eSIsInJlbmRlckxpc3QiLCJ1cGRhdGVBY3RpdmVJdGVtc0ZpZWxkIiwidGl0bGUiLCJhZGRJdGVtIiwic2V0VmlldyIsImlkIiwic2V0SXRlbVRpdGxlIiwiY29tcGxldGVkIiwic2V0QWxsQ29tcGxldGlvbiIsInN0b3JhZ2VWYXJOYW1lIiwicHVzaFRvU3RvcmFnZSIsImxvY2FsU3RvcmFnZSIsInNldEl0ZW0iLCJKU09OIiwic3RyaW5naWZ5IiwicHVsbEZyb21TdG9yYWdlIiwicGFyc2UiLCJnZXRJdGVtIiwiZmlsdGVyIiwidG9kbyIsImZvckVhY2giLCJpdGVtIiwidHJpbSIsInB1c2giLCJmaW5kIiwiaXMiLCJpbmRleCIsInNwbGljZSIsInRlbXBsYXRlcyIsInNlY3Rpb25Ub2RvYXBwIiwic2VjdGlvbk1haW4iLCJpbnB1dE5ld1RvZG8iLCJidXR0b25Ub2dnbGVBbGwiLCJidXR0b25DbGVhckNvbXBsZXRlZCIsInVsVG9kb0xpc3QiLCJjb3VudGVyIiwiZm9vdGVyIiwiZmlsdGVycyIsInZpc2libGUiLCJzdHlsZSIsImRpc3BsYXkiLCJjaGVja2VkIiwiY3VyckJ1dHQiLCJxdWVyeVNlbGVjdG9yQWxsIiwibm9kZSIsImNsYXNzTGlzdCIsInJlbW92ZSIsImFkZCIsImZyYWdtZW50IiwiY2hpbGQiLCJmaXJzdENoaWxkIiwicmVtb3ZlQ2hpbGQiLCJhcHBlbmRDaGlsZCIsImhhbmRsZXIiLCJ0YWdOYW1lIiwibGkiLCJwYXJlbnRFbGVtZW50IiwiZWRpdCIsImNyZWF0ZUVsZW1lbnQiLCJpbm5lclRleHQiLCJmb2N1cyIsImRhdGFzZXQiLCJjYW5jZWxsZWQiLCJldmVudCIsImtleSIsImJsdXIiLCJjb250YWlucyIsImNyZWF0ZURvY3VtZW50RnJhZ21lbnQiLCJjb25zdHJ1Y3RvciIsIm5ld0l0ZW1MaSIsInNldExpc3RDb250ZW50IiwiYWN0aXZlSXRlbXMiLCJuZXdDb3VudGVyIiwibmV3VG9kb0NvdW50U3BhbiIsInJlcGxhY2VDaGlsZCIsImlubmVySFRNTCIsIml0ZW1zQW1vdW50Iiwic3VmZml4Iiwid2luZG93Il0sIm1hcHBpbmdzIjoiYUFDQSxJQUFBQSxLQUdBLFNBQUFDLEVBQUFDLEdBR0EsR0FBQUYsRUFBQUUsR0FDQSxPQUFBRixFQUFBRSxHQUFBQyxRQUdBLElBQUFDLEVBQUFKLEVBQUFFLElBQ0FHLEVBQUFILEVBQ0FJLEdBQUEsRUFDQUgsWUFVQSxPQU5BSSxFQUFBTCxHQUFBTSxLQUFBSixFQUFBRCxRQUFBQyxJQUFBRCxRQUFBRixHQUdBRyxFQUFBRSxHQUFBLEVBR0FGLEVBQUFELFFBS0FGLEVBQUFRLEVBQUFGLEVBR0FOLEVBQUFTLEVBQUFWLEVBR0FDLEVBQUFVLEVBQUEsU0FBQVIsRUFBQVMsRUFBQUMsR0FDQVosRUFBQWEsRUFBQVgsRUFBQVMsSUFDQUcsT0FBQUMsZUFBQWIsRUFBQVMsR0FDQUssY0FBQSxFQUNBQyxZQUFBLEVBQ0FDLElBQUFOLEtBTUFaLEVBQUFtQixFQUFBLFNBQUFqQixHQUNBWSxPQUFBQyxlQUFBYixFQUFBLGNBQWlEa0IsT0FBQSxLQUlqRHBCLEVBQUFxQixFQUFBLFNBQUFsQixHQUNBLElBQUFTLEVBQUFULEtBQUFtQixXQUNBLFdBQTJCLE9BQUFuQixFQUFBLFNBQzNCLFdBQWlDLE9BQUFBLEdBRWpDLE9BREFI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QUFvQyxFQUFBckYsS0FBQTBELFVBQUF3QyxZQUFBQyxVQUFBbEQsR0FDQTZCLEVBQUFJLFlBQUFHLEtBRUFyRixLQUFBb0csZUFBQXRCLEdBT0FqRix1QkFBQXdHLEdBQ0EsTUFBQUMsRUFBQXRHLEtBQUEwRCxVQUFBd0MsWUFBQUssaUJBQUFGLEdBQ0FyRyxLQUFBaUUsUUFBQXFCLGNBQUFrQixhQUFBRixFQUFBdEcsS0FBQWlFLFNBQ0FqRSxLQUFBaUUsUUFBQXFDLElINU1BLFVJTEF6RyxpQkFBQW9ELEdBQ0EsTUFBQW9DLEVBQUF0RyxTQUFBeUcsY0FBQSxNQWNBLE9BWkFILEVBQUFNLFFBQUF4RCxHQUFBYyxFQUFBZCxHQUNBa0QsRUFBQW9CLDRIQUUrQnhELEVBQUFqQixxR0FJL0JpQixFQUFBWixZQUNBZ0QsRUFBQVYsVUFBQUUsSUFBQSxhQUNBakcsRUFBQSxVQUFBeUcsR0FBQWQsU0FBQSxHQUdBYyxFQUdBeEYsd0JBQUE2RyxHQUNBLE1BQUF6QyxFQUFBbEYsU0FBQXlHLGNBQUEsUUFDQW1CLEVBQUFELEVBQUEsYUFLQSxPQUhBekMsRUFBQVUsVUFBQUUsSUFBQSxjQUNBWixFQUFBd0MscUJBQW1DQyxrQkFBNEJDLFNBRS9EMUMsTUpmQWhGLEVBQUEySCxPQUFBLFdBQUFoSCxFQUFBc0MsV0FDQWpELEVBQUEySCxPQUFBLGlCQUFBaEgsRUFBQXNDIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbiBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4gXHRcdFx0XHRnZXQ6IGdldHRlclxuIFx0XHRcdH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG4iLCJleHBvcnQgZnVuY3Rpb24gcXMoc2VsZWN0b3IsIHNjb3BlKSB7XG4gIHJldHVybiAoc2NvcGUgfHwgZG9jdW1lbnQpLnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2V0TGlzdGVuZXIodGFyZ2V0LCBldmVudFR5cGUsIGNhbGxiYWNrKSB7XG4gIHRhcmdldC5hZGRFdmVudExpc3RlbmVyKGV2ZW50VHlwZSwgY2FsbGJhY2spO1xufVxuIiwiZnVuY3Rpb24gczQoKSB7XG4gIHJldHVybiBNYXRoLmZsb29yKCgxICsgTWF0aC5yYW5kb20oKSkgKiAweDEwMDAwKVxuICAgIC50b1N0cmluZygxNilcbiAgICAuc3Vic3RyaW5nKDEpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2VuZXJVbmlxSWQoKSB7XG4gIHJldHVybiBgJHtzNCgpICsgczQoKX0tJHtzNCgpfS0ke3M0KCl9LSR7czQoKX0tJHtzNCgpfSR7czQoKX0ke3M0KCl9YDtcbn1cbiIsImltcG9ydCB7IHNldExpc3RlbmVyIH0gZnJvbSAnLi9oZWxwZXJzL2hlbHBlcnMnO1xuaW1wb3J0IFN0b3JlTW9kZWwgZnJvbSAnLi9tb2RlbC9zdG9yZV9tb2RlbCc7XG5pbXBvcnQgVGVtcGxhdGVzIGZyb20gJy4vdmlldy90ZW1wbGF0ZXMnO1xuaW1wb3J0IFZpZXcgZnJvbSAnLi92aWV3L3ZpZXcnO1xuaW1wb3J0IENvbnRyb2xsZXIgZnJvbSAnLi9jb250cm9sbGVyL2NvbnRyb2xsZXInO1xuXG5jb25zdCBtb2RlbCA9IG5ldyBTdG9yZU1vZGVsKCd0b2RvLWFzdHJpZWxvdicpO1xuXG5jb25zdCB0ZW1wbGF0ZXMgPSBuZXcgVGVtcGxhdGVzKCk7XG5jb25zdCB2aWV3ID0gbmV3IFZpZXcodGVtcGxhdGVzKTtcblxuY29uc3QgY29udHJvbGxlciA9IG5ldyBDb250cm9sbGVyKG1vZGVsLCB2aWV3KTtcblxuc2V0TGlzdGVuZXIod2luZG93LCAnbG9hZCcsICgpID0+IGNvbnRyb2xsZXIuc2V0VmlldygpKTtcbnNldExpc3RlbmVyKHdpbmRvdywgJ2hhc2hjaGFuZ2UnLCAoKSA9PiBjb250cm9sbGVyLnNldFZpZXcoKSk7XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBDb250cm9sbGVyIHtcbiAgY29uc3RydWN0b3IobW9kZWwsIHZpZXcpIHtcbiAgICB0aGlzLm1vZGVsID0gbW9kZWw7XG4gICAgdGhpcy52aWV3ID0gdmlldztcblxuICAgIHRoaXMudmlldy5saXN0ZW5Ub2dnbGVBbGwodGhpcy50b2dnbGVBbGwuYmluZCh0aGlzKSk7XG4gICAgdGhpcy52aWV3Lmxpc3Rlbk5ld1RvRG8odGhpcy5uZXdUb0RvLmJpbmQodGhpcykpO1xuICAgIHRoaXMudmlldy5saXN0ZW5Ub0l0ZW1DaGFuZ2UodGhpcy5lbmRFZGl0SXRlbS5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLnZpZXcubGlzdGVuVG9JdGVtUmVtb3ZlKHRoaXMucmVtb3ZlSXRlbS5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLnZpZXcubGlzdGVuVG9JdGVtVG9nZ2xlKHRoaXMudG9nZ2xlSXRlbS5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLnZpZXcubGlzdGVuVG9SZW1vdmVDb21wbGV0ZWQodGhpcy5yZW1vdmVDb21wbGV0ZWQuYmluZCh0aGlzKSk7XG4gIH1cblxuICBzZXRWaWV3KHJhdyA9IGRvY3VtZW50LmxvY2F0aW9uLmhhc2gpIHtcbiAgICBjb25zdCByb3V0ZSA9IHJhdy5yZXBsYWNlKC9eI1xcLy8sICcnKTtcbiAgICBsZXQgY3VycmVudFRvZG9zO1xuICAgIHN3aXRjaCAocm91dGUpIHtcbiAgICAgIGNhc2UgJ2FjdGl2ZSc6XG4gICAgICAgIGN1cnJlbnRUb2RvcyA9IHRoaXMubW9kZWwuZ2V0SW5jb21wbGV0ZWQoKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdjb21wbGV0ZWQnOlxuICAgICAgICBjdXJyZW50VG9kb3MgPSB0aGlzLm1vZGVsLmdldENvbXBsZXRlZCgpO1xuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGN1cnJlbnRUb2RvcyA9IHRoaXMubW9kZWwudG9kb3M7XG4gICAgfVxuICAgIHRoaXMudmlldy5zZXRUb2dnbGVBbGxTdGF0ZSh0aGlzLm1vZGVsLmFsbENvbXBsZXRlKCkpO1xuICAgIHRoaXMudmlldy5zZXRDaG9zZW5GaWx0ZXIocm91dGUpO1xuICAgIHRoaXMudmlldy5zZXRNYWluVmlzaWJpbGl0eSh0aGlzLm1vZGVsLnRvZG9zLmxlbmd0aCk7XG4gICAgdGhpcy52aWV3LnNldEZvb3RlclZpc2liaWxpdHkodGhpcy5tb2RlbC50b2Rvcy5sZW5ndGgpO1xuICAgIHRoaXMudmlldy5zZXRDbGVhckJ1dHRWaXNpYmlsaXR5KHRoaXMubW9kZWwuZ2V0Q29tcGxldGVkKCkubGVuZ3RoKTtcbiAgICB0aGlzLnZpZXcucmVuZGVyTGlzdChjdXJyZW50VG9kb3MpO1xuICAgIHRoaXMudmlldy51cGRhdGVBY3RpdmVJdGVtc0ZpZWxkKHRoaXMubW9kZWwuZ2V0SW5jb21wbGV0ZWQoKS5sZW5ndGgpO1xuICB9XG5cbiAgbmV3VG9Ebyh0aXRsZSkge1xuICAgIHRoaXMubW9kZWwuYWRkSXRlbSh0aXRsZSk7XG4gICAgdGhpcy5zZXRWaWV3KCk7XG4gIH1cblxuICBlbmRFZGl0SXRlbSh0aXRsZSwgaWQpIHtcbiAgICB0aGlzLm1vZGVsLnNldEl0ZW1UaXRsZSh0aXRsZSwgaWQpO1xuICAgIHRoaXMuc2V0VmlldygpO1xuICB9XG5cbiAgdG9nZ2xlQWxsKGNvbXBsZXRlZCkge1xuICAgIHRoaXMubW9kZWwuc2V0QWxsQ29tcGxldGlvbihjb21wbGV0ZWQpO1xuICAgIHRoaXMuc2V0VmlldygpO1xuICB9XG5cbiAgdG9nZ2xlSXRlbShpZCkge1xuICAgIHRoaXMubW9kZWwudG9nZ2xlSXRlbShpZCk7XG4gICAgdGhpcy5zZXRWaWV3KCk7XG4gIH1cblxuICByZW1vdmVJdGVtKGlkKSB7XG4gICAgdGhpcy5tb2RlbC5yZW1vdmVJdGVtKGlkKTtcbiAgICB0aGlzLnNldFZpZXcoKTtcbiAgfVxuXG4gIHJlbW92ZUNvbXBsZXRlZCgpIHtcbiAgICB0aGlzLm1vZGVsLnJlbW92ZUNvbXBsZXRlZCgpO1xuICAgIHRoaXMuc2V0VmlldygpO1xuICB9XG59XG4iLCJpbXBvcnQgeyBnZW5lclVuaXFJZCB9IGZyb20gJy4uL2hlbHBlcnMvaWRfZ2VuZXJhdG9yJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU3RvcmVNb2RlbCB7XG4gIGNvbnN0cnVjdG9yKHN0b3JhZ2VWYXJOYW1lKSB7XG4gICAgdGhpcy50b2RvcyA9IFtdO1xuXG4gICAgdGhpcy5wdXNoVG9TdG9yYWdlID0gKCkgPT4ge1xuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oc3RvcmFnZVZhck5hbWUsIEpTT04uc3RyaW5naWZ5KHRoaXMudG9kb3MpKTtcbiAgICB9O1xuXG4gICAgdGhpcy5wdWxsRnJvbVN0b3JhZ2UgPSAoKSA9PiB7XG4gICAgICB0aGlzLnRvZG9zID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShzdG9yYWdlVmFyTmFtZSkgfHwgJ1tdJyk7XG4gICAgfTtcblxuICAgIHRoaXMucHVsbEZyb21TdG9yYWdlKCk7XG4gIH1cblxuICBnZXRDb21wbGV0ZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMudG9kb3MuZmlsdGVyKHRvZG8gPT4gdG9kby5jb21wbGV0ZWQpO1xuICB9XG5cbiAgZ2V0SW5jb21wbGV0ZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMudG9kb3MuZmlsdGVyKHRvZG8gPT4gIXRvZG8uY29tcGxldGVkKTtcbiAgfVxuXG4gIHNldEFsbENvbXBsZXRpb24oY29tcGxldGVkKSB7XG4gICAgdGhpcy50b2Rvcy5mb3JFYWNoKChpdGVtKSA9PiB7IGl0ZW0uY29tcGxldGVkID0gISFjb21wbGV0ZWQ7IH0pO1xuICAgIHRoaXMucHVzaFRvU3RvcmFnZSgpO1xuICB9XG5cbiAgYWxsQ29tcGxldGUoKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0Q29tcGxldGVkKCkubGVuZ3RoID09PSB0aGlzLnRvZG9zLmxlbmd0aDtcbiAgfVxuXG4gIHJlbW92ZUNvbXBsZXRlZCgpIHtcbiAgICB0aGlzLnRvZG9zID0gdGhpcy5nZXRJbmNvbXBsZXRlZCgpO1xuICAgIHRoaXMucHVzaFRvU3RvcmFnZSgpO1xuICB9XG5cbiAgYWRkSXRlbSh0aXRsZSkge1xuICAgIHRpdGxlID0gdGl0bGUudHJpbSgpO1xuICAgIGlmICh0aXRsZSkge1xuICAgICAgY29uc3QgaXRlbSA9IHtcbiAgICAgICAgdGl0bGUsXG4gICAgICAgIGlkOiBnZW5lclVuaXFJZCgpLFxuICAgICAgICBjb21wbGV0ZWQ6IGZhbHNlLFxuICAgICAgfTtcbiAgICAgIHRoaXMudG9kb3MucHVzaChpdGVtKTtcbiAgICAgIHRoaXMucHVzaFRvU3RvcmFnZSgpO1xuICAgIH1cbiAgfVxuXG4gIHNldEl0ZW1UaXRsZSh0aXRsZSwgaWQpIHtcbiAgICB0aXRsZSA9IHRpdGxlLnRyaW0oKTtcbiAgICBjb25zdCB0b2RvID0gdGhpcy50b2Rvcy5maW5kKGl0ZW0gPT4gT2JqZWN0LmlzKGl0ZW0uaWQsIGlkKSk7XG4gICAgaWYgKHRpdGxlKSB7XG4gICAgICB0b2RvLnRpdGxlID0gdGl0bGU7XG4gICAgICB0aGlzLnB1c2hUb1N0b3JhZ2UoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5yZW1vdmVJdGVtKGlkKTtcbiAgICB9XG4gIH1cblxuICByZW1vdmVJdGVtKGlkKSB7XG4gICAgdGhpcy50b2Rvcy5mb3JFYWNoKCh0b2RvLCBpbmRleCkgPT4ge1xuICAgICAgaWYgKE9iamVjdC5pcyh0b2RvLmlkLCBpZCkpIHtcbiAgICAgICAgdGhpcy50b2Rvcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHRoaXMucHVzaFRvU3RvcmFnZSgpO1xuICB9XG5cbiAgdG9nZ2xlSXRlbShpZCkge1xuICAgIHRoaXMudG9kb3MuZm9yRWFjaCgodG9kbykgPT4ge1xuICAgICAgaWYgKE9iamVjdC5pcyh0b2RvLmlkLCBpZCkpIHtcbiAgICAgICAgdG9kby5jb21wbGV0ZWQgPSAhdG9kby5jb21wbGV0ZWQ7XG4gICAgICAgIHRoaXMucHVzaFRvU3RvcmFnZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG4iLCJpbXBvcnQgeyBxcywgc2V0TGlzdGVuZXIgfSBmcm9tICcuLi9oZWxwZXJzL2hlbHBlcnMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBWaWV3IHtcbiAgLyoqXG4gICAqIEFzc2lnbnMgYWxsIG1ham9yIEhUTUwgbm9kZXMgdG8gVmlldyBpbnN0YW5jZVxuICAgKiBAcGFyYW0gdGVtcGxhdGVzIC0gY29udGFpbnMgdGVtcGxhdGUgZm9yIDxsaT4gZWxlbWVudCBhbmQgaXRlbXMgY291bnRlclxuICAgKi9cbiAgY29uc3RydWN0b3IodGVtcGxhdGVzKSB7XG4gICAgdGhpcy50ZW1wbGF0ZXMgPSB0ZW1wbGF0ZXM7XG4gICAgdGhpcy5zZWN0aW9uVG9kb2FwcCA9IHFzKCcudG9kb2FwcCcpO1xuICAgIHRoaXMuc2VjdGlvbk1haW4gPSBxcygnLm1haW4nLCB0aGlzLnNlY3Rpb25Ub2RvYXBwKTtcbiAgICB0aGlzLmlucHV0TmV3VG9kbyA9IHFzKCcubmV3LXRvZG8nLCB0aGlzLnNlY3Rpb25Ub2RvYXBwKTtcbiAgICB0aGlzLmJ1dHRvblRvZ2dsZUFsbCA9IHFzKCcudG9nZ2xlLWFsbCcsIHRoaXMuc2VjdGlvblRvZG9hcHApO1xuICAgIHRoaXMuYnV0dG9uQ2xlYXJDb21wbGV0ZWQgPSBxcygnLmNsZWFyLWNvbXBsZXRlZCcsIHRoaXMuc2VjdGlvblRvZG9hcHApO1xuICAgIHRoaXMudWxUb2RvTGlzdCA9IHFzKCcudG9kby1saXN0JywgdGhpcy5zZWN0aW9uVG9kb2FwcCk7XG4gICAgdGhpcy5jb3VudGVyID0gcXMoJy50b2RvLWNvdW50JywgdGhpcy5zZWN0aW9uVG9kb2FwcCk7XG4gICAgdGhpcy5mb290ZXIgPSBxcygnLmZvb3RlcicsIHRoaXMuc2VjdGlvblRvZG9hcHApO1xuICAgIHRoaXMuZmlsdGVycyA9IHFzKCcuZmlsdGVycycsIHRoaXMuc2VjdGlvblRvZG9hcHApO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldCB2aXNpYmxlL2ludmlzaWJsZSBub2RlIGNvbnRhaW5pbmcgbGlzdCBvZiB0b2Rvc1xuICAgKiBAcGFyYW0ge2Jvb2xlYW59IHZpc2libGVcbiAgICovXG4gIHNldE1haW5WaXNpYmlsaXR5KHZpc2libGUpIHtcbiAgICB0aGlzLnNlY3Rpb25NYWluLnN0eWxlLmRpc3BsYXkgPSB2aXNpYmxlID8gJ2Jsb2NrJyA6ICdub25lJztcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXQgdmlzaWJsZS9pbnZpc2libGUgbm9kZSBjb250YWluaW5nIHRvZG9zIGZpbHRlcnMgYW5kIGNvdW50ZXJcbiAgICogQHBhcmFtIHtib29sZWFufSB2aXNpYmxlXG4gICAqL1xuICBzZXRGb290ZXJWaXNpYmlsaXR5KHZpc2libGUpIHtcbiAgICB0aGlzLmZvb3Rlci5zdHlsZS5kaXNwbGF5ID0gdmlzaWJsZSA/ICdibG9jaycgOiAnbm9uZSc7XG4gIH1cblxuICAvKipcbiAgICogU2V0IHZpc2libGUvaW52aXNpYmxlIGNsZWFyQ29tcGxldGVUb0RvcyBidXR0b25cbiAgICogQHBhcmFtIHtib29sZWFufSB2aXNpYmxlXG4gICAqL1xuICBzZXRDbGVhckJ1dHRWaXNpYmlsaXR5KHZpc2libGUpIHtcbiAgICB0aGlzLmJ1dHRvbkNsZWFyQ29tcGxldGVkLnN0eWxlLmRpc3BsYXkgPSB2aXNpYmxlID8gJ2Jsb2NrJyA6ICdub25lJztcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXQgc3RhdGUgb2YgdG9nZ2xlIGFsbCBmbGFnXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gYWxsQ29tcGxldGVcbiAgICovXG4gIHNldFRvZ2dsZUFsbFN0YXRlKGFsbENvbXBsZXRlKSB7XG4gICAgdGhpcy5idXR0b25Ub2dnbGVBbGwuY2hlY2tlZCA9IGFsbENvbXBsZXRlO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldCB2aXN1YWwgaGlnaGxpZ2h0aW5nIG9mIGZpbHRlciBiYXNlZCBvbiBjdXJyZW50IGxpc3Qgdmlld1xuICAgKiBAcGFyYW0ge1N0cmluZ30gcm91dGVcbiAgICovXG4gIHNldENob3NlbkZpbHRlcihyb3V0ZSkge1xuICAgIHRoaXMuZmlsdGVycy5xdWVyeVNlbGVjdG9yQWxsKCdhJykuZm9yRWFjaChub2RlID0+IG5vZGUuY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQnKSk7XG4gICAgbGV0IGN1cnJCdXR0O1xuICAgIHN3aXRjaCAocm91dGUpIHtcbiAgICAgIGNhc2UgJ2FjdGl2ZSc6XG4gICAgICAgIGN1cnJCdXR0ID0gcXMoJyNzaG93QWN0aXZlJywgdGhpcy5maWx0ZXJzKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdjb21wbGV0ZWQnOlxuICAgICAgICBjdXJyQnV0dCA9IHFzKCcjc2hvd0NvbXBsZXRlZCcsIHRoaXMuZmlsdGVycyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgY3VyckJ1dHQgPSBxcygnI3Nob3dBbGwnLCB0aGlzLmZpbHRlcnMpO1xuICAgIH1cbiAgICBjdXJyQnV0dC5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpO1xuICB9XG5cbiAgLyoqXG4gICAqIFdpcGUgb2xkIFRvRG9zIGFuZCBwYXN0ZSB0aGUgbmV3IG9uZXNcbiAgICogQHBhcmFtIHtEb2N1bWVudEZyYWdtZW50fSBmcmFnbWVudFxuICAgKi9cbiAgc2V0TGlzdENvbnRlbnQoZnJhZ21lbnQpIHtcbiAgICBsZXQgY2hpbGQgPSB0aGlzLnVsVG9kb0xpc3QuZmlyc3RDaGlsZDtcbiAgICB3aGlsZSAoY2hpbGQpIHtcbiAgICAgIHRoaXMudWxUb2RvTGlzdC5yZW1vdmVDaGlsZChjaGlsZCk7XG4gICAgICBjaGlsZCA9IHRoaXMudWxUb2RvTGlzdC5maXJzdENoaWxkO1xuICAgIH1cbiAgICB0aGlzLnVsVG9kb0xpc3QuYXBwZW5kQ2hpbGQoZnJhZ21lbnQpO1xuICB9XG5cbiAgLyoqXG4gICAqIEF0dGFjaCAnY2xpY2snIGxpc3RlbmVyIHRvIHRvZ2dsZSBhbGwgZmxhZy4gQ2FsbHMgaGFuZGxlciB3aXRoIGNoZWNrZWQgc3RhdGVcbiAgICogQHBhcmFtIHtmdW5jdGlvbn0gaGFuZGxlclxuICAgKi9cbiAgbGlzdGVuVG9nZ2xlQWxsKGhhbmRsZXIpIHtcbiAgICBzZXRMaXN0ZW5lcih0aGlzLmJ1dHRvblRvZ2dsZUFsbCwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgY29uc3QgY29tcGxldGVkID0gdGhpcy5idXR0b25Ub2dnbGVBbGwuY2hlY2tlZDtcbiAgICAgIGhhbmRsZXIoY29tcGxldGVkKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBdHRhY2ggJ2NoYW5nZScgbGlzdGVuZXIgdG8gTmV3VG9kbyBpbnB1dC4gQ2FsbHMgaGFuZGxlciB3aXRoIGlucHV0IHZhbHVlIHRoZW4gd2lwZXMgaW5wdXRcbiAgICogQHBhcmFtIHtmdW5jdGlvbn0gaGFuZGxlclxuICAgKi9cbiAgbGlzdGVuTmV3VG9EbyhoYW5kbGVyKSB7XG4gICAgc2V0TGlzdGVuZXIodGhpcy5pbnB1dE5ld1RvZG8sICdjaGFuZ2UnLCAoKSA9PiB7XG4gICAgICBoYW5kbGVyKHRoaXMuaW5wdXROZXdUb2RvLnZhbHVlKTtcbiAgICAgIHRoaXMuaW5wdXROZXdUb2RvLnZhbHVlID0gJyc7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogQXR0YWNoIGRvdWJsZSBjbGljayBsaXN0ZW5lciB0byBsaXN0LiBJZiBkYmxjbGlja2VkIG9uIGl0ZW0gbGFiZWwsIGF0dGFjaCBuZXcgJ2VkaXQnXG4gICAqIGlucHV0IGZpZWxkIGZvciBjaGFuZ2luZyBpdGVtIHRpdGxlLiBPbiBlZGl0IGZpbmlzaCBjYWxscyBoYW5kbGVyIHdpdGggaW5wdXQgdmFsdWUgaWZcbiAgICogbm90IGNhbmNlbGxlZC4gRGVsZXRlcyAnZWRpdCcgZWxlbWVudC5cbiAgICogQHBhcmFtIHtmdW5jdGlvbn0gaGFuZGxlclxuICAgKi9cbiAgbGlzdGVuVG9JdGVtQ2hhbmdlKGhhbmRsZXIpIHtcbiAgICBzZXRMaXN0ZW5lcih0aGlzLnVsVG9kb0xpc3QsICdkYmxjbGljaycsICh7IHRhcmdldCB9KSA9PiB7XG4gICAgICBpZiAoIU9iamVjdC5pcyh0YXJnZXQudGFnTmFtZSwgJ0xBQkVMJykpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBsaSA9IHRhcmdldC5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQ7XG4gICAgICBjb25zdCBlZGl0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgICAgIGVkaXQuY2xhc3NMaXN0LmFkZCgnZWRpdCcpO1xuICAgICAgZWRpdC52YWx1ZSA9IHRhcmdldC5pbm5lclRleHQ7XG4gICAgICBsaS5hcHBlbmRDaGlsZChlZGl0KTtcbiAgICAgIGxpLmNsYXNzTGlzdC5hZGQoJ2VkaXRpbmcnKTtcbiAgICAgIGVkaXQuZm9jdXMoKTtcblxuICAgICAgc2V0TGlzdGVuZXIoZWRpdCwgJ2JsdXInLCAoKSA9PiB7XG4gICAgICAgIGlmICghZWRpdC5kYXRhc2V0LmNhbmNlbGxlZCkge1xuICAgICAgICAgIGhhbmRsZXIoZWRpdC52YWx1ZSwgbGkuZGF0YXNldC5pZCk7XG4gICAgICAgIH1cbiAgICAgICAgbGkuY2xhc3NMaXN0LnJlbW92ZSgnZWRpdGluZycpO1xuICAgICAgICBsaS5yZW1vdmVDaGlsZChlZGl0KTtcbiAgICAgIH0pO1xuXG4gICAgICBzZXRMaXN0ZW5lcihlZGl0LCAna2V5ZG93bicsIChldmVudCkgPT4ge1xuICAgICAgICBpZiAoZXZlbnQua2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgICAgIGVkaXQuZGF0YXNldC5jYW5jZWxsZWQgPSAndHJ1ZSc7XG4gICAgICAgICAgZWRpdC5ibHVyKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGV2ZW50LmtleSA9PT0gJ0VudGVyJykge1xuICAgICAgICAgIGVkaXQuYmx1cigpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBdHRhY2ggJ2NsaWNrJyBsaXN0ZW5lciB0byB0b2RvcyBsaXN0LiBJZiBjbGlja2VkIG9uIHJlbW92ZUl0ZW0gYnV0dG9uLCBjYWxscyBoYW5kbGVyLCBwYXNzaW5nXG4gICAqIGl0ZW0gaWQgdG8gaXQuXG4gICAqIEBwYXJhbSB7ZnVuY3Rpb259IGhhbmRsZXJcbiAgICovXG4gIGxpc3RlblRvSXRlbVJlbW92ZShoYW5kbGVyKSB7XG4gICAgc2V0TGlzdGVuZXIodGhpcy51bFRvZG9MaXN0LCAnY2xpY2snLCAoeyB0YXJnZXQgfSkgPT4ge1xuICAgICAgaWYgKCF0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdkZXN0cm95JykpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY29uc3QgbGkgPSB0YXJnZXQucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50O1xuICAgICAgaGFuZGxlcihsaS5kYXRhc2V0LmlkKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBdHRhY2ggJ2NsaWNrJyBsaXN0ZW5lciB0byAnY2xlYXIgY29tcGxldGVkJyBidXR0b24uIENhbGxzIGhhbmRsZXIgb24gY2xpY2tcbiAgICogQHBhcmFtIHtmdW5jdGlvbn0gaGFuZGxlclxuICAgKi9cbiAgbGlzdGVuVG9SZW1vdmVDb21wbGV0ZWQoaGFuZGxlcikge1xuICAgIHNldExpc3RlbmVyKHRoaXMuYnV0dG9uQ2xlYXJDb21wbGV0ZWQsICdjbGljaycsICgpID0+IHtcbiAgICAgIGhhbmRsZXIoKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBdHRhY2ggJ2NsaWNrJyBsaXN0ZW5lciB0byB0b2RvcyBsaXN0LiBJZiBjbGlja2VkIG9uICd0b2dnbGUgaXRlbScgYnV0dG9uLCBzd2l0Y2hlcyB2aXN1YWxcbiAgICogc3RhdGUgb2YgYnV0dG9uIGFuZCBjYWxscyBoYW5kbGVyLlxuICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBoYW5kbGVyXG4gICAqL1xuICBsaXN0ZW5Ub0l0ZW1Ub2dnbGUoaGFuZGxlcikge1xuICAgIHNldExpc3RlbmVyKHRoaXMudWxUb2RvTGlzdCwgJ2NsaWNrJywgKHsgdGFyZ2V0IH0pID0+IHtcbiAgICAgIGlmICghdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygndG9nZ2xlJykpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY29uc3QgbGkgPSB0YXJnZXQucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50O1xuICAgICAgaWYgKGxpLmNsYXNzTGlzdC5jb250YWlucygnY29tcGxldGVkJykpIHtcbiAgICAgICAgbGkuY2xhc3NMaXN0LnJlbW92ZSgnY29tcGxldGVkJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBsaS5jbGFzc0xpc3QuYWRkKCdjb21wbGV0ZWQnKTtcbiAgICAgIH1cbiAgICAgIGhhbmRsZXIobGkuZGF0YXNldC5pZCk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlIGRvY3VtZW50RnJhZ21lbnQgY29udGFpbmluZyA8bGk+cyBmcm9tIGN1cnJlbnQgdG9kb3MgYW5kIHBhc3MgaXQgdG8gc2V0TGlzdENvbnRlbnRcbiAgICogQHBhcmFtIHtBcnJheX0gdG9kb3MgLSBhcnJheSBvZiBvYmplY3RzXG4gICAqL1xuICByZW5kZXJMaXN0KHRvZG9zKSB7XG4gICAgY29uc3QgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgdG9kb3MuZm9yRWFjaCgodG9kbykgPT4ge1xuICAgICAgY29uc3QgbGkgPSB0aGlzLnRlbXBsYXRlcy5jb25zdHJ1Y3Rvci5uZXdJdGVtTGkodG9kbyk7XG4gICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZChsaSk7XG4gICAgfSk7XG4gICAgdGhpcy5zZXRMaXN0Q29udGVudChmcmFnbWVudCk7XG4gIH1cblxuICAvKipcbiAgICogU3dhcCBjdXJyZW50IGNvdW50ZXIgZmllbGQuXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBhY3RpdmVJdGVtcyAtIGFtb3VudCBvZiBjdXJyZW50IGluY29tcGxldGUgdG9kb3NcbiAgICovXG4gIHVwZGF0ZUFjdGl2ZUl0ZW1zRmllbGQoYWN0aXZlSXRlbXMpIHtcbiAgICBjb25zdCBuZXdDb3VudGVyID0gdGhpcy50ZW1wbGF0ZXMuY29uc3RydWN0b3IubmV3VG9kb0NvdW50U3BhbihhY3RpdmVJdGVtcyk7XG4gICAgdGhpcy5jb3VudGVyLnBhcmVudEVsZW1lbnQucmVwbGFjZUNoaWxkKG5ld0NvdW50ZXIsIHRoaXMuY291bnRlcik7XG4gICAgdGhpcy5jb3VudGVyID0gbmV3Q291bnRlcjtcbiAgfVxufVxuIiwiaW1wb3J0IHsgcXMgfSBmcm9tICcuLi9oZWxwZXJzL2hlbHBlcnMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBUZW1wbGF0ZXMge1xuICBzdGF0aWMgbmV3SXRlbUxpKHRvZG8pIHtcbiAgICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG5cbiAgICBsaS5kYXRhc2V0LmlkID0gdG9kby5pZDtcbiAgICBsaS5pbm5lckhUTUwgPSBgPGRpdiBjbGFzcz1cInZpZXdcIj5cbiAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgY2xhc3M9XCJ0b2dnbGVcIiB0eXBlPVwiY2hlY2tib3hcIj5cbiAgICAgICAgICAgICAgICAgICAgICA8bGFiZWw+JHt0b2RvLnRpdGxlfTwvbGFiZWw+XG4gICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImRlc3Ryb3lcIj48L2J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+YDtcblxuICAgIGlmICh0b2RvLmNvbXBsZXRlZCkge1xuICAgICAgbGkuY2xhc3NMaXN0LmFkZCgnY29tcGxldGVkJyk7XG4gICAgICBxcygnLnRvZ2dsZScsIGxpKS5jaGVja2VkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gbGk7XG4gIH1cblxuICBzdGF0aWMgbmV3VG9kb0NvdW50U3BhbihpdGVtc0Ftb3VudCkge1xuICAgIGNvbnN0IGNvdW50ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgY29uc3Qgc3VmZml4ID0gaXRlbXNBbW91bnQgJSAxMCA9PT0gMSA/ICcnIDogJ3MnO1xuXG4gICAgY291bnRlci5jbGFzc0xpc3QuYWRkKCd0b2RvLWNvdW50Jyk7XG4gICAgY291bnRlci5pbm5lckhUTUwgPSBgPHN0cm9uZz4ke2l0ZW1zQW1vdW50fTwvc3Ryb25nPiBpdGVtJHtzdWZmaXh9IGxlZnRgO1xuXG4gICAgcmV0dXJuIGNvdW50ZXI7XG4gIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=