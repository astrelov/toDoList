!function(t){var e={};function o(s){if(e[s])return e[s].exports;var i=e[s]={i:s,l:!1,exports:{}};return t[s].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=e,o.d=function(t,e,s){o.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:s})},o.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=0)}([function(t,e,o){"use strict";function s(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}o.r(e);class i{constructor(t){this.uid=`${s()+s()}-${s()}-${s()}-${s()}-${s()}${s()}${s()}`,this.title=t,this.completed=!1}setTitle(t){this.title=t}switchState(){this.completed=!this.completed}setCompleted(){this.completed=!0}setIncompleted(){this.completed=!1}isCompleted(){return this.completed}}new class{constructor(t,e){this.model=t,this.view=e}}(new class{constructor(t){this.todos=[],this.activeItems=0,this.pushToStorage=(()=>{localStorage.setItem(t,JSON.stringify(this.todos))}),this.pullFromStorage=(()=>{this.todos=JSON.parse(localStorage.getItem(t)||"[]"),this.updateActiveItems()}),this.pullFromStorage()}getCompleted(){return this.todos.filter(t=>t.isCompleted())}getIncompleted(){return this.todos.filter(t=>!t.isCompleted())}setAllComplete(){this.todos.forEach(t=>t.setCompleted()),this.updateActiveItems()}setAllIncomplete(){this.todos.forEach(t=>t.setIncompleted()),this.updateActiveItems()}allComplete(){return this.getCompleted().length===this.todos.length}allIncomplete(){return this.getIncompleted().length===this.todos.length}removeCompleted(){this.todos=this.getIncompleted(),this.pushToStorage()}addItem(t){(t=t.trim())&&(this.todos.push(new i(t)),this.pushToStorage(),this.updateActiveItems())}setItemTitle(t,e){t=t.trim();const o=this.todos.find(t=>!t.id.localeCompare(e));t?(o.setTitle(t),this.pushToStorage()):this.removeItem(e)}removeItem(t){this.todos.forEach((e,o)=>{0===e.id.localeCompare(t)&&this.todos.splice(o,1)}),this.pushToStorage(),this.updateActiveItems()}updateActiveItems(){this.activeItems=this.getIncompleted().length}}("todo-astrielov"),new class{constructor(){}})}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vanMvaGVscGVycy9pZEdlbmVyYXRvci5qcyIsIndlYnBhY2s6Ly8vLi9qcy9tb2RlbC9pdGVtTW9kZWwuanMiLCJ3ZWJwYWNrOi8vLy4vanMvYXBwLmpzIiwid2VicGFjazovLy8uL2pzL2NvbnRyb2xsZXIvY29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly8vLi9qcy9tb2RlbC9zdG9yZU1vZGVsLmpzIiwid2VicGFjazovLy8uL2pzL3ZpZXcvdmlldy5qcyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiY29uZmlndXJhYmxlIiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJ2YWx1ZSIsIm4iLCJfX2VzTW9kdWxlIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiczQiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJ0b1N0cmluZyIsInN1YnN0cmluZyIsIml0ZW1Nb2RlbF9JdGVtTW9kZWwiLCJbb2JqZWN0IE9iamVjdF0iLCJ0aXRsZSIsInRoaXMiLCJ1aWQiLCJjb21wbGV0ZWQiLCJtb2RlbCIsInZpZXciLCJzdG9yYWdlVmFyTmFtZSIsInRvZG9zIiwiYWN0aXZlSXRlbXMiLCJwdXNoVG9TdG9yYWdlIiwibG9jYWxTdG9yYWdlIiwic2V0SXRlbSIsIkpTT04iLCJzdHJpbmdpZnkiLCJwdWxsRnJvbVN0b3JhZ2UiLCJwYXJzZSIsImdldEl0ZW0iLCJ1cGRhdGVBY3RpdmVJdGVtcyIsImZpbHRlciIsInRvZG8iLCJpc0NvbXBsZXRlZCIsImZvckVhY2giLCJzZXRDb21wbGV0ZWQiLCJzZXRJbmNvbXBsZXRlZCIsImdldENvbXBsZXRlZCIsImxlbmd0aCIsImdldEluY29tcGxldGVkIiwidHJpbSIsInB1c2giLCJpZCIsIml0ZW0iLCJmaW5kIiwibG9jYWxlQ29tcGFyZSIsInNldFRpdGxlIiwicmVtb3ZlSXRlbSIsImluZGV4Iiwic3BsaWNlIl0sIm1hcHBpbmdzIjoiYUFDQSxJQUFBQSxLQUdBLFNBQUFDLEVBQUFDLEdBR0EsR0FBQUYsRUFBQUUsR0FDQSxPQUFBRixFQUFBRSxHQUFBQyxRQUdBLElBQUFDLEVBQUFKLEVBQUFFLElBQ0FHLEVBQUFILEVBQ0FJLEdBQUEsRUFDQUgsWUFVQSxPQU5BSSxFQUFBTCxHQUFBTSxLQUFBSixFQUFBRCxRQUFBQyxJQUFBRCxRQUFBRixHQUdBRyxFQUFBRSxHQUFBLEVBR0FGLEVBQUFELFFBS0FGLEVBQUFRLEVBQUFGLEVBR0FOLEVBQUFTLEVBQUFWLEVBR0FDLEVBQUFVLEVBQUEsU0FBQVIsRUFBQVMsRUFBQUMsR0FDQVosRUFBQWEsRUFBQVgsRUFBQVMsSUFDQUcsT0FBQUMsZUFBQWIsRUFBQVMsR0FDQUssY0FBQSxFQUNBQyxZQUFBLEVBQ0FDLElBQUFOLEtBTUFaLEVBQUFtQixFQUFBLFNBQUFqQixHQUNBWSxPQUFBQyxlQUFBYixFQUFBLGNBQWlEa0IsT0FBQSxLQUlqRHBCLEVBQUFxQixFQUFBLFNBQUFsQixHQUNBLElBQUFTLEVBQUFULEtBQUFtQixXQUNBLFdBQTJCLE9BQUFuQixFQUFBLFNBQzNCLFdBQWlDLE9BQUFBLEdBRWpDLE9BREFILEVBQUFVLEVBQUFFLEVBQUEsSUFBQUEsR0FDQUEsR0FJQVosRUFBQWEsRUFBQSxTQUFBVSxFQUFBQyxHQUFzRCxPQUFBVixPQUFBVyxVQUFBQyxlQUFBbkIsS0FBQWdCLEVBQUFDLElBR3REeEIsRUFBQTJCLEVBQUEsR0FJQTNCLElBQUE0QixFQUFBLGtDQ25FQSxTQUFBQyxJQUNBLE9BQUFDLEtBQUFDLE1BQUEsU0FBQUQsS0FBQUUsV0FDQUMsU0FBQSxJQUNBQyxVQUFBLGdCQ0RBQyxFQUNBQyxZQUFBQyxHQUNBQyxLQUFBQyxPREdZVixXQUFlQSxPQUFRQSxPQUFRQSxPQUFRQSxNQUFPQSxNQUFPQSxNQ0ZqRVMsS0FBQUQsUUFDQUMsS0FBQUUsV0FBQSxFQUdBSixTQUFBQyxHQUNBQyxLQUFBRCxRQUdBRCxjQUNBRSxLQUFBRSxXQUFBRixLQUFBRSxVQUdBSixlQUNBRSxLQUFBRSxXQUFBLEVBR0FKLGlCQUNBRSxLQUFBRSxXQUFBLEVBR0FKLGNBQ0EsT0FBQUUsS0FBQUUsV0NuQkEsVUNMQUosWUFBQUssRUFBQUMsR0FDQUosS0FBQUcsUUFDQUgsS0FBQUksU0RDQSxVRUZBTixZQUFBTyxHQUNBTCxLQUFBTSxTQUNBTixLQUFBTyxZQUFBLEVBRUFQLEtBQUFRLGNBQUEsTUFDQUMsYUFBQUMsUUFBQUwsRUFBQU0sS0FBQUMsVUFBQVosS0FBQU0sVUFHQU4sS0FBQWEsZ0JBQUEsTUFDQWIsS0FBQU0sTUFBQUssS0FBQUcsTUFBQUwsYUFBQU0sUUFBQVYsSUFBQSxNQUNBTCxLQUFBZ0Isc0JBR0FoQixLQUFBYSxrQkFHQWYsZUFDQSxPQUFBRSxLQUFBTSxNQUFBVyxPQUFBQyxLQUFBQyxlQUdBckIsaUJBQ0EsT0FBQUUsS0FBQU0sTUFBQVcsT0FBQUMsTUFBQUMsZUFHQXJCLGlCQUNBRSxLQUFBTSxNQUFBYyxRQUFBRixLQUFBRyxnQkFDQXJCLEtBQUFnQixvQkFHQWxCLG1CQUNBRSxLQUFBTSxNQUFBYyxRQUFBRixLQUFBSSxrQkFDQXRCLEtBQUFnQixvQkFHQWxCLGNBQ0EsT0FBQUUsS0FBQXVCLGVBQUFDLFNBQUF4QixLQUFBTSxNQUFBa0IsT0FHQTFCLGdCQUNBLE9BQUFFLEtBQUF5QixpQkFBQUQsU0FBQXhCLEtBQUFNLE1BQUFrQixPQUdBMUIsa0JBQ0FFLEtBQUFNLE1BQUFOLEtBQUF5QixpQkFDQXpCLEtBQUFRLGdCQUdBVixRQUFBQyxJQUNBQSxJQUFBMkIsVUFFQTFCLEtBQUFNLE1BQUFxQixLQUFBLElBQUE5QixFQUFBRSxJQUNBQyxLQUFBUSxnQkFDQVIsS0FBQWdCLHFCQUlBbEIsYUFBQUMsRUFBQTZCLEdBQ0E3QixJQUFBMkIsT0FDQSxNQUFBRyxFQUFBN0IsS0FBQU0sTUFBQXdCLEtBQUFaLE1BQUFVLEdBQUFHLGNBQUFILElBQ0E3QixHQUNBOEIsRUFBQUcsU0FBQWpDLEdBQ0FDLEtBQUFRLGlCQUVBUixLQUFBaUMsV0FBQUwsR0FJQTlCLFdBQUE4QixHQUNBNUIsS0FBQU0sTUFBQWMsUUFBQSxDQUFBRixFQUFBZ0IsS0FDQSxJQUFBaEIsRUFBQVUsR0FBQUcsY0FBQUgsSUFDQTVCLEtBQUFNLE1BQUE2QixPQUFBRCxFQUFBLEtBR0FsQyxLQUFBUSxnQkFDQVIsS0FBQWdCLG9CQUdBbEIsb0JBQ0FFLEtBQUFPLFlBQUFQLEtBQUF5QixpQkFBQUQsU0Y1RUEsa0JBQ0EsVUdKQTFCIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbiBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4gXHRcdFx0XHRnZXQ6IGdldHRlclxuIFx0XHRcdH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG4iLCJmdW5jdGlvbiBzNCgpIHtcbiAgcmV0dXJuIE1hdGguZmxvb3IoKDEgKyBNYXRoLnJhbmRvbSgpKSAqIDB4MTAwMDApXG4gICAgLnRvU3RyaW5nKDE2KVxuICAgIC5zdWJzdHJpbmcoMSk7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdlbmVyVW5pcUlkKCkge1xuICByZXR1cm4gYCR7czQoKSArIHM0KCl9LSR7czQoKX0tJHtzNCgpfS0ke3M0KCl9LSR7czQoKX0ke3M0KCl9JHtzNCgpfWA7XG59XG4iLCJpbXBvcnQgZ2VuZXJVbmlxSWQgZnJvbSAnLi4vaGVscGVycy9pZEdlbmVyYXRvcic7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEl0ZW1Nb2RlbCB7XG4gIGNvbnN0cnVjdG9yKHRpdGxlKSB7XG4gICAgdGhpcy51aWQgPSBnZW5lclVuaXFJZCgpO1xuICAgIHRoaXMudGl0bGUgPSB0aXRsZTtcbiAgICB0aGlzLmNvbXBsZXRlZCA9IGZhbHNlO1xuICB9XG5cbiAgc2V0VGl0bGUodGl0bGUpIHtcbiAgICB0aGlzLnRpdGxlID0gdGl0bGU7XG4gIH1cblxuICBzd2l0Y2hTdGF0ZSgpIHtcbiAgICB0aGlzLmNvbXBsZXRlZCA9ICF0aGlzLmNvbXBsZXRlZDtcbiAgfVxuXG4gIHNldENvbXBsZXRlZCgpIHtcbiAgICB0aGlzLmNvbXBsZXRlZCA9IHRydWU7XG4gIH1cblxuICBzZXRJbmNvbXBsZXRlZCgpIHtcbiAgICB0aGlzLmNvbXBsZXRlZCA9IGZhbHNlO1xuICB9XG5cbiAgaXNDb21wbGV0ZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuY29tcGxldGVkO1xuICB9XG59XG4iLCJpbXBvcnQgU3RvcmVNb2RlbCBmcm9tICcuL21vZGVsL3N0b3JlTW9kZWwnO1xuaW1wb3J0IFZpZXcgZnJvbSAnLi92aWV3L3ZpZXcnO1xuaW1wb3J0IENvbnRyb2xsZXIgZnJvbSAnLi9jb250cm9sbGVyL2NvbnRyb2xsZXInO1xuXG5cbmNvbnN0IG1vZGVsID0gbmV3IFN0b3JlTW9kZWwoJ3RvZG8tYXN0cmllbG92Jyk7XG5jb25zdCB2aWV3ID0gbmV3IFZpZXcoKTtcbmNvbnN0IGNvbnRyb2xsZXIgPSBuZXcgQ29udHJvbGxlcihtb2RlbCwgdmlldyk7XG5cbiIsIlxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ29udHJvbGxlciB7XG4gIGNvbnN0cnVjdG9yKG1vZGVsLCB2aWV3KSB7XG4gICAgdGhpcy5tb2RlbCA9IG1vZGVsO1xuICAgIHRoaXMudmlldyA9IHZpZXc7XG4gIH1cblxuXG59XG5cblxuIiwiaW1wb3J0IEl0ZW1Nb2RlbCBmcm9tICcuL2l0ZW1Nb2RlbCc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFN0b3JlTW9kZWwge1xuICBjb25zdHJ1Y3RvcihzdG9yYWdlVmFyTmFtZSkge1xuICAgIHRoaXMudG9kb3MgPSBbXTtcbiAgICB0aGlzLmFjdGl2ZUl0ZW1zID0gMDtcblxuICAgIHRoaXMucHVzaFRvU3RvcmFnZSA9ICgpID0+IHtcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKHN0b3JhZ2VWYXJOYW1lLCBKU09OLnN0cmluZ2lmeSh0aGlzLnRvZG9zKSk7XG4gICAgfTtcblxuICAgIHRoaXMucHVsbEZyb21TdG9yYWdlID0gKCkgPT4ge1xuICAgICAgdGhpcy50b2RvcyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oc3RvcmFnZVZhck5hbWUpIHx8ICdbXScpO1xuICAgICAgdGhpcy51cGRhdGVBY3RpdmVJdGVtcygpO1xuICAgIH07XG5cbiAgICB0aGlzLnB1bGxGcm9tU3RvcmFnZSgpO1xuICB9XG5cbiAgZ2V0Q29tcGxldGVkKCkge1xuICAgIHJldHVybiB0aGlzLnRvZG9zLmZpbHRlcih0b2RvID0+IHRvZG8uaXNDb21wbGV0ZWQoKSk7XG4gIH1cblxuICBnZXRJbmNvbXBsZXRlZCgpIHtcbiAgICByZXR1cm4gdGhpcy50b2Rvcy5maWx0ZXIodG9kbyA9PiAhdG9kby5pc0NvbXBsZXRlZCgpKTtcbiAgfVxuXG4gIHNldEFsbENvbXBsZXRlKCkge1xuICAgIHRoaXMudG9kb3MuZm9yRWFjaCh0b2RvID0+IHRvZG8uc2V0Q29tcGxldGVkKCkpO1xuICAgIHRoaXMudXBkYXRlQWN0aXZlSXRlbXMoKTtcbiAgfVxuXG4gIHNldEFsbEluY29tcGxldGUoKSB7XG4gICAgdGhpcy50b2Rvcy5mb3JFYWNoKHRvZG8gPT4gdG9kby5zZXRJbmNvbXBsZXRlZCgpKTtcbiAgICB0aGlzLnVwZGF0ZUFjdGl2ZUl0ZW1zKCk7XG4gIH1cblxuICBhbGxDb21wbGV0ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRDb21wbGV0ZWQoKS5sZW5ndGggPT09IHRoaXMudG9kb3MubGVuZ3RoO1xuICB9XG5cbiAgYWxsSW5jb21wbGV0ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRJbmNvbXBsZXRlZCgpLmxlbmd0aCA9PT0gdGhpcy50b2Rvcy5sZW5ndGg7XG4gIH1cblxuICByZW1vdmVDb21wbGV0ZWQoKSB7XG4gICAgdGhpcy50b2RvcyA9IHRoaXMuZ2V0SW5jb21wbGV0ZWQoKTtcbiAgICB0aGlzLnB1c2hUb1N0b3JhZ2UoKTtcbiAgfVxuXG4gIGFkZEl0ZW0odGl0bGUpIHtcbiAgICB0aXRsZSA9IHRpdGxlLnRyaW0oKVxuICAgIGlmICh0aXRsZSkge1xuICAgICAgdGhpcy50b2Rvcy5wdXNoKG5ldyBJdGVtTW9kZWwodGl0bGUpKTtcbiAgICAgIHRoaXMucHVzaFRvU3RvcmFnZSgpO1xuICAgICAgdGhpcy51cGRhdGVBY3RpdmVJdGVtcygpO1xuICAgIH1cbiAgfVxuXG4gIHNldEl0ZW1UaXRsZSh0aXRsZSwgaWQpIHtcbiAgICB0aXRsZSA9IHRpdGxlLnRyaW0oKTtcbiAgICBjb25zdCBpdGVtID0gdGhpcy50b2Rvcy5maW5kKHRvZG8gPT4gIXRvZG8uaWQubG9jYWxlQ29tcGFyZShpZCkpO1xuICAgIGlmICh0aXRsZSkge1xuICAgICAgaXRlbS5zZXRUaXRsZSh0aXRsZSk7XG4gICAgICB0aGlzLnB1c2hUb1N0b3JhZ2UoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5yZW1vdmVJdGVtKGlkKTtcbiAgICB9XG4gIH1cblxuICByZW1vdmVJdGVtKGlkKSB7XG4gICAgdGhpcy50b2Rvcy5mb3JFYWNoKCh0b2RvLCBpbmRleCkgPT4ge1xuICAgICAgaWYgKHRvZG8uaWQubG9jYWxlQ29tcGFyZShpZCkgPT09IDApIHtcbiAgICAgICAgdGhpcy50b2Rvcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHRoaXMucHVzaFRvU3RvcmFnZSgpO1xuICAgIHRoaXMudXBkYXRlQWN0aXZlSXRlbXMoKTtcbiAgfVxuXG4gIHVwZGF0ZUFjdGl2ZUl0ZW1zKCkge1xuICAgIHRoaXMuYWN0aXZlSXRlbXMgPSB0aGlzLmdldEluY29tcGxldGVkKCkubGVuZ3RoO1xuICB9XG59XG4iLCJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFZpZXcge1xuICBjb25zdHJ1Y3RvcigpIHtcblxuICB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9